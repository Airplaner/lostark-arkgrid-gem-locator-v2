<script lang="ts">
  import imgCorePoint from '../assets/corepoint.png';
  import imgWillPower from '../assets/willpower.png';
  import { type ArkGridGem, getGemImage } from '../lib/models/arkGridGems';
  import { deleteGem } from '../lib/state/profile.state.svelte';

  interface Props {
    gem: ArkGridGem;
    showDeleteButton?: boolean;
  }

  let { gem, showDeleteButton = true }: Props = $props();
</script>

<div class="gem-box">
  <div class="gem">
    <div class="col gemImage" data-grade={gem.grade}>
      <img src={getGemImage(gem.gemAttr, gem.name)} alt={gem.name} />
    </div>
    <div class="col main-options">
      <div class="main-option">
        <span> {gem.req}</span>
        <img src={imgWillPower} alt="W" />
      </div>
      <div class="main-option">
        {gem.point}<img src={imgCorePoint} alt="P" />
      </div>
    </div>
    <div class="vl"></div>
    <div class="col sub-options">
      <div class="sub-option">
        <span class="option-type">
          {gem.option1.optionType}
        </span>
        <span class="option-level">
          Lv.{gem.option1.value}
        </span>
      </div>
      <div class="sub-option">
        <span class="option-type">
          {gem.option2.optionType}
        </span>
        <span class="option-level">
          Lv.{gem.option2.value}
        </span>
      </div>
    </div>
  </div>
  {#if showDeleteButton}
    <div class="edit-button">
      <button onclick={() => deleteGem(gem)}>ğŸ—‘ï¸</button>
    </div>
  {/if}
</div>

<style>
  .gem-box {
    border: 1px solid var(--border);
    border-radius: 0.4rem;
    display: inline-flex;
    height: 3rem;
    padding: 0.4rem;
    justify-content: space-between;
    align-items: center;
  }
  .gem-box .edit-button {
    flex: 0 0 auto;
  }
  .gem {
    /* min-width: 12rem; */
    max-width: 30rem;
    height: 100%;

    /* ë””ë²„ê¹… */
    /* border: 1px solid blue; */

    /* ë‚´ë¶€ ìš”ì†Œ */
    display: flex;
    /* justify-content: space-between; */
    align-items: center;

    overflow: hidden;
    overflow-y: hidden;

    flex-grow: 1;
    flex-shrink: 0;
    /* ì™¸ê´€ */
  }
  .gem > .col.main-options > .main-option {
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }
  .gem > .col.main-options img {
    display: block;
    height: 80%;

    /* ì‚´ì§ ì˜¬ë¼ê°€ë³´ì´ëŠ” ê²ƒì„ ë³´ì • */
    transform: translateY(1px);
  }
  .gem > .col.gemImage {
    flex: 1;
    min-width: 1.5rem;
    max-width: 2.5rem;
  }
  .gem > .col > img {
    height: 100%;
    object-fit: contain;
    transform: translateX(1px);
  }

  .gem > .col.main-options {
    flex: 1;
    min-width: 1.5rem;
    max-width: 2.5rem;
  }

  .gem > .vl {
    width: 0px;
    border-left: 1px solid rgb(156, 156, 156);
    height: 80%;
    justify-content: center;
  }

  .gem > .col.sub-options {
    flex: 4;
    min-width: 2rem;
  }
  .gem > .col.sub-options > .sub-option {
    /* ì•„êµ° ê³µê²© ê°•í™” Lv.3  ì´ëŸ° ë¬¸êµ¬ëŠ” ë°˜ë“œì‹œ í•œ ì¤„ */
    white-space: nowrap;
  }

  .gem > .col {
    /* ë””ë²„ê¹… */
    /* border: 1px solid red; */
    /* ì™¸ê´€ */
    height: 100%;
    margin: 0.5rem;

    /* ë‚´ë¶€ ìš”ì†Œë“¤ì€ ì¤‘ì•™ ì •ë ¬ */
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 0.1em;
    flex-wrap: nowrap;
  }
  div[data-grade] {
    border-radius: 20%;
  }
  /* ê³µí™ˆ ì½”ì–´ css*/
  div[data-grade='ì „ì„¤'] {
    background: linear-gradient(135deg, #4d3000, #bc7d01);
  }

  div[data-grade='ìœ ë¬¼'] {
    background: linear-gradient(135deg, #341a09, #a24006);
  }

  div[data-grade='ê³ ëŒ€'] {
    background: linear-gradient(135deg, #3d3325, #dcc999);
  }
</style>
